<!-- 1) Container for messages -->
<div id="messages"
	 style="border:1px solid #ccc;
              height:300px;
              overflow-y:auto;
              padding:8px;
              margin-bottom:8px;">
</div>

<input id="msgInput" placeholder="Type a message…" />
<button id="sendBtn">Send</button>

<!-- SignalR client -->
<script src="https://cdn.jsdelivr.net/npm/@@microsoft/signalr@@latest/dist/browser/signalr.min.js"></script>
<script>
	const API_BASE = "https://localhost:7136";

			// 2) Build the connection
			const connection = new signalR.HubConnectionBuilder()
				.withUrl(`${API_BASE}/messagesHub`)
			.withAutomaticReconnect()
				.build();

			// 3) When a message arrives, append it to the #messages div
			connection.on("ReceiveMessage", (msg) => {
			  const container = document.getElementById("messages");
			const el = document.createElement("div");
			el.textContent = `${msg.senderId}: ${msg.text}`;  // adjust if your payload differs
			container.appendChild(el);

			  // scroll down to newest
			container.scrollTop = container.scrollHeight;
			});

		// 4) Start SignalR
			connection.start()
		  .then(() => console.log("Connected to hub"))
			  .catch(err => console.error(err));

			// 5) Wire up the Send button
			document.getElementById("sendBtn").addEventListener("click", async () => {
			  const text = document.getElementById("msgInput").value.trim();
		  if (!text) return;

			await fetch(`${API_BASE}/api/message/send`, {
				method: "POST",
				headers: { "Content-Type": "application/json" },
				body: JSON.stringify({
				  senderId: "alice",       // replace with actual user ID
				  recipientId: "bob",      // replace with actual recipient
				  text
				})
			  });

			  document.getElementById("msgInput").value = "";
			});
</script>